%% Landau Free Energy
f1_landau = a1122.*(2.*P1_FilmRef.^3.*P2_FilmRef.^4 + 12.*P1_FilmRef.^3.*P2_FilmRef.^2.*P3_FilmRef.^2 + 2.*P1_FilmRef.^3.*P3_FilmRef.^4) + 2.*P1_FilmRef.*a1 + a112.*(4.*P1_FilmRef.^3.*P2_FilmRef.^2 + 4.*P1_FilmRef.^3.*P3_FilmRef.^2 + P1_FilmRef.*P2_FilmRef.^4 + 6.*P1_FilmRef.*P2_FilmRef.^2.*P3_FilmRef.^2 + P1_FilmRef.*P3_FilmRef.^4) + 4.*P1_FilmRef.^3.*a11 + 6.*P1_FilmRef.^5.*a111 + 8.*P1_FilmRef.^7.*a1111 + a1112.*(6.*P1_FilmRef.^5.*P2_FilmRef.^2 + 6.*P1_FilmRef.^5.*P3_FilmRef.^2 + (P1_FilmRef.*P2_FilmRef.^6)/2 + (15.*P1_FilmRef.*P2_FilmRef.^4.*P3_FilmRef.^2)/2 + (15.*P1_FilmRef.*P2_FilmRef.^2.*P3_FilmRef.^4)/2 + (P1_FilmRef.*P3_FilmRef.^6)/2) + a12.*(2.*P1_FilmRef.*P2_FilmRef.^2 + 2.*P1_FilmRef.*P3_FilmRef.^2) + a1123.*(P1_FilmRef.^3.*P2_FilmRef.^4 - 2.*P1_FilmRef.^3.*P2_FilmRef.^2.*P3_FilmRef.^2 + P1_FilmRef.^3.*P3_FilmRef.^4 + (P1_FilmRef.*P2_FilmRef.^6)/2 - (P1_FilmRef.*P2_FilmRef.^4.*P3_FilmRef.^2)/2 - (P1_FilmRef.*P2_FilmRef.^2.*P3_FilmRef.^4)/2 + (P1_FilmRef.*P3_FilmRef.^6)/2) + a123.*((P1_FilmRef.*P2_FilmRef.^4)/2 - P1_FilmRef.*P2_FilmRef.^2.*P3_FilmRef.^2 + (P1_FilmRef.*P3_FilmRef.^4)/2);
f2_landau = 2.*P2_FilmRef.*a1 - a1123.*(- P1_FilmRef.^4.*P2_FilmRef.^3 + P1_FilmRef.^4.*P2_FilmRef.*P3_FilmRef.^2 - (3.*P1_FilmRef.^2.*P2_FilmRef.^5)/2 + P1_FilmRef.^2.*P2_FilmRef.^3.*P3_FilmRef.^2 + (P1_FilmRef.^2.*P2_FilmRef.*P3_FilmRef.^4)/2) + a1112.*(2.*P1_FilmRef.^6.*P2_FilmRef + (3.*P1_FilmRef.^2.*P2_FilmRef.^5)/2 + 15.*P1_FilmRef.^2.*P2_FilmRef.^3.*P3_FilmRef.^2 + (15.*P1_FilmRef.^2.*P2_FilmRef.*P3_FilmRef.^4)/2 + P2_FilmRef.^7 + 3.*P2_FilmRef.^5.*P3_FilmRef.^2 - 5.*P2_FilmRef.^3.*P3_FilmRef.^4 + P2_FilmRef.*P3_FilmRef.^6) + a111.*((3.*P2_FilmRef.^5)/2 + 15.*P2_FilmRef.^3.*P3_FilmRef.^2 + (15.*P2_FilmRef.*P3_FilmRef.^4)/2) + a112.*(2.*P1_FilmRef.^4.*P2_FilmRef + 2.*P1_FilmRef.^2.*P2_FilmRef.^3 + 6.*P1_FilmRef.^2.*P2_FilmRef.*P3_FilmRef.^2 + (3.*P2_FilmRef.^5)/2 - P2_FilmRef.^3.*P3_FilmRef.^2 - (P2_FilmRef.*P3_FilmRef.^4)/2) + a12.*(2.*P1_FilmRef.^2.*P2_FilmRef + P2_FilmRef.^3 - P2_FilmRef.*P3_FilmRef.^2) + a11.*(2.*P2_FilmRef.^3 + 6.*P2_FilmRef.*P3_FilmRef.^2) + a1111.*(P2_FilmRef.^7 + 21.*P2_FilmRef.^5.*P3_FilmRef.^2 + 35.*P2_FilmRef.^3.*P3_FilmRef.^4 + 7.*P2_FilmRef.*P3_FilmRef.^6) + a1122.*(2.*P1_FilmRef.^4.*P2_FilmRef.^3 + 6.*P1_FilmRef.^4.*P2_FilmRef.*P3_FilmRef.^2 + P2_FilmRef.^7/2 - (3.*P2_FilmRef.^5.*P3_FilmRef.^2)/2 + (3.*P2_FilmRef.^3.*P3_FilmRef.^4)/2 - (P2_FilmRef.*P3_FilmRef.^6)/2) + a123.*(P1_FilmRef.^2.*P2_FilmRef.^3 - P1_FilmRef.^2.*P2_FilmRef.*P3_FilmRef.^2);
f3_landau = 2.*P3_FilmRef.*a1 - a1123.*(P1_FilmRef.^4.*P2_FilmRef.^2.*P3_FilmRef - P1_FilmRef.^4.*P3_FilmRef.^3 + (P1_FilmRef.^2.*P2_FilmRef.^4.*P3_FilmRef)/2 + P1_FilmRef.^2.*P2_FilmRef.^2.*P3_FilmRef.^3 - (3.*P1_FilmRef.^2.*P3_FilmRef.^5)/2) + a1112.*(2.*P1_FilmRef.^6.*P3_FilmRef + (15.*P1_FilmRef.^2.*P2_FilmRef.^4.*P3_FilmRef)/2 + 15.*P1_FilmRef.^2.*P2_FilmRef.^2.*P3_FilmRef.^3 + (3.*P1_FilmRef.^2.*P3_FilmRef.^5)/2 + P2_FilmRef.^6.*P3_FilmRef - 5.*P2_FilmRef.^4.*P3_FilmRef.^3 + 3.*P2_FilmRef.^2.*P3_FilmRef.^5 + P3_FilmRef.^7) + a111.*((15.*P2_FilmRef.^4.*P3_FilmRef)/2 + 15.*P2_FilmRef.^2.*P3_FilmRef.^3 + (3.*P3_FilmRef.^5)/2) + a112.*(2.*P1_FilmRef.^4.*P3_FilmRef + 6.*P1_FilmRef.^2.*P2_FilmRef.^2.*P3_FilmRef + 2.*P1_FilmRef.^2.*P3_FilmRef.^3 - (P2_FilmRef.^4.*P3_FilmRef)/2 - P2_FilmRef.^2.*P3_FilmRef.^3 + (3.*P3_FilmRef.^5)/2) + a12.*(2.*P1_FilmRef.^2.*P3_FilmRef - P2_FilmRef.^2.*P3_FilmRef + P3_FilmRef.^3) + a11.*(6.*P2_FilmRef.^2.*P3_FilmRef + 2.*P3_FilmRef.^3) + a1111.*(7.*P2_FilmRef.^6.*P3_FilmRef + 35.*P2_FilmRef.^4.*P3_FilmRef.^3 + 21.*P2_FilmRef.^2.*P3_FilmRef.^5 + P3_FilmRef.^7) + a1122.*(6.*P1_FilmRef.^4.*P2_FilmRef.^2.*P3_FilmRef + 2.*P1_FilmRef.^4.*P3_FilmRef.^3 - (P2_FilmRef.^6.*P3_FilmRef)/2 + (3.*P2_FilmRef.^4.*P3_FilmRef.^3)/2 - (3.*P2_FilmRef.^2.*P3_FilmRef.^5)/2 + P3_FilmRef.^7/2) + a123.*(- P1_FilmRef.^2.*P2_FilmRef.^2.*P3_FilmRef + P1_FilmRef.^2.*P3_FilmRef.^3);

f1_landau = f1_landau .* in_film .* Nucleation_Sites;
f2_landau = f2_landau .* in_film .* Nucleation_Sites;
f3_landau = f3_landau .* in_film .* Nucleation_Sites;

f1_landau_2Dk = fft_2d_slices(f1_landau);
f2_landau_2Dk = fft_2d_slices(f2_landau);
f3_landau_2Dk = fft_2d_slices(f3_landau);