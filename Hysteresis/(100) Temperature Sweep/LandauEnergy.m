%% Landau Free Energy
f1_landau = ( P1 .* ( ...
    2 .* a1 + 4 .* a11 .* P1.^2 + 2 .* a12 .* ( P2.^2 + P3.^2 ) + ...
    6 .* a111 .* P1.^4 + 2 .* a112 .* ( P2.^4 + P3.^4 + 2 .* P1.^2 .* ( P2.^2 + P3.^2 ) ) + ...
    2 .* a123 .* P2.^2 .* P3.^2 + ...
    8 .* a1111 .* P1.^6 + 2 .* a1112.* ( P2.^6 + P3.^6 + 3 .* P1.^4 .* ( P2.^2 + P3.^2 ) ) + ...
    4 .* a1122 .* P1.^2 .* ( P2.^4 + P3.^4 ) + ...
    2 .* a1123 .* ( 2 .* P1.^2 .* P2.^2 .* P3.^2 + P2.^2 .* P3.^2 .* ( P2.^2 + P3.^2 ) ) ) ) .* in_film .* Nucleation_Sites;

f2_landau = ( P2 .* ( ...
    2 .* a1 + 4 .* a11 .* P2.^2 + 2 .* a12 .* ( P3.^2 + P1.^2 ) + ...
    6 .* a111 .* P2.^4 + 2 .* a112 .* ( P3.^4 + P1.^4 + 2 .* P2.^2 .* ( P3.^2 + P1.^2 ) ) + ...
    2 .* a123 .* P3.^2 .* P1.^2 + ...
    8 .* a1111 .* P2.^6 + 2 .* a1112.* ( P3.^6 + P1.^6 + 3 .* P2.^4 .* ( P3.^2 + P1.^2 ) ) + ...
    4 .* a1122 .* P2.^2 .* ( P3.^4 + P1.^4 ) + ...
    2 .* a1123 .* ( 2 .* P2.^2 .* P3.^2 .* P1.^2 + P3.^2 .* P1.^2 .* ( P3.^2 + P1.^2 ) ) ) ) .* in_film .* Nucleation_Sites;

f3_landau = ( P3 .* ( ...
    2 .* a1 + 4 .* a11 .* P3.^2 + 2 .* a12 .* ( P1.^2 + P2.^2 ) + ...
    6 .* a111 .* P3.^4 + 2 .* a112 .* ( P1.^4 + P2.^4 + 2 .* P3.^2 .* ( P1.^2 + P2.^2 ) ) + ...
    2 .* a123 .* P1.^2 .* P2.^2 + ...
    8 .* a1111 .* P3.^6 + 2 .* a1112.* ( P1.^6 + P2.^6 + 3 .* P3.^4 .* ( P1.^2 + P2.^2 ) ) + ...
    4 .* a1122 .* P3.^2 .* ( P1.^4 + P2.^4 ) + ...
    2 .* a1123 .* ( 2 .* P3.^2 .* P1.^2 .* P2.^2 + P1.^2 .* P2.^2 .* ( P1.^2 + P2.^2 ) ) ) ) .* in_film .* Nucleation_Sites;

f1_landau_2Dk = fft_2d_slices(f1_landau);
f2_landau_2Dk = fft_2d_slices(f2_landau);
f3_landau_2Dk = fft_2d_slices(f3_landau);